## 概述

数学规划是运筹学的一个分支，其用来研究在给定的条件下（约束条件），如何按照某一衡量指标（目标函数）来寻求计划、管理工作中的最优方案。用数学语言说明，即为求目标函数在一定的约束条件下的极值问题。

### 一般形式
$$ \max (或\min) z = f(x) / \sum_{j=1}^nc_jx_j$$
$$st.(subject \quad to，受约束于) \begin{cases} \sum_{j=1}^n a_{ij}x_j \leq(/\ge/=) b_i \\ x_j \ge 0, j= 1,2,...,n \end{cases}$$
也可写成$st. g_i(x) \leq 0, i=1,2,...,n$，也可能有等式约束，整数约束，或两者皆有。

我们把 $x$ 称为决策变量（一般有多个），$f(x)$称为目标函数，含有约束的等式、不等式等称为约束条件。

### 分类
**线性规划：**
	如果目标函数$f(x)$和约束条件均是决策变量的线性表达式，那么此时的数学规划问题就属于线性规划
**非线性规划：**
	当目标函数$f(x)$或者约束条件中有一个是决策变量$x$的非线性表达式，那么此时的数学规划问题就属于非线性规划，目前没有通用算法
**整数规划：**
	一类要求变量取整数值的数学规划，分为线性与非线性整数规划。目前大部分算法往往只适用于线性整数规划，非线性整数规划可采用蒙特卡洛模拟来求解
**01规划：** 
	整数规划的特例，整数变量的取值只能为0和1

## 多目标规划问题

### 基本理论
在进行多目标决策时，当希望每个目标都尽可能大（或尽可能小）时，就形成了一个多目标规划问题，其一般形式为$$\min f(x)=[f_1(x), f_2(x),...,f_m(x)]^T, \tag{5.1}$$
$$st. \begin{cases} g_i(x) \leq 0, & i = 1,2,...,p \\ h_j(x)=0, & j=1,2,...,q \tag{5.2} \end{cases}$$
其中，$x$为决策向量，$f_1(x), \ f_2(x)$为目标函数，式(5.2)为约束条件。记$\Omega$为多目标规划的可行域（决策空间）：
$$\Omega=\{x|g_i(x) \leq 0, i=1,2,...,p; \quad h_j(x)=0,j=1,2,...,q\}$$
$f(\Omega)=\{f(x)|x\in \Omega\}$为多目标规划问题的像集（目标空间）。

**定义：**
设$\bar x \in \Omega$，若多余任意$i=1,2,...,m$及任意$x\in \Omega$，均有$$f_(\bar x) \leq f_i(x)$$则称$\bar x$为问题（MP）的绝对最优解，及问题（MP）的绝对最优解集为$\Omega_{ab}^*$

但由于多目标规划问题的绝对最优解不常见，因此常用非劣解或有效解，也称为Pareto最优解:

**定义：**
考虑多目标规划问题（MP），设$\bar x \in \Omega$，若不存在$x \in \Omega$使得$$f_i(\bar x) \leq f_( x) ,i=1,2,...,m,$$
但至少有一个$$f_j(\bar x)< f_j( x)$$则称$\bar x$为问题（MP）的*有效解*，$f(\bar x)$为有效点

**满意解：**
这一概念主要是从决策角度，根据决策者的偏好与要求提出的。
设可行域为$\Omega$，要求$m$个目标函数$f_i(i=1,2,...,m)$越小越好。有时决策者的期望较低，给出了$m$个阈值$\alpha_i$，当$\bar x \in \Omega$满足$f_i(\bar x) \leq \alpha_i(i=1,2,...,m)$时，就认为$\bar x$是可以接受的，是满意的。

### 求解思路
某一个规划问题中有多个目标，例如企业再保证利润最大时也要保证生产时产生的污染最小，这种情况下我们可以对多目标函数进行加权组合或是划分优先级，使其**变成单目标规划**，然后再利用先前学的知识进行求解。

#### 线性加权法
该方法的基本思想是根据目标的重要性确定一个权重，以目标函数的加权平均值为评价函数，使其达到最优。基本步骤如下：

1. 确定每个目标的**权系数**
	$$ 0 \leq w_j\leq 1, j = 1,2,...,m;\quad \sum_{j=1}^m w_j=1$$
2. **写出评价函数**$\sum_{j=1}^m w_j f_j$
3. **求评价函数最优值**
	$$\min \sum_{i=1}^m w_if_i(x),\quad st.x\in \Omega $$
该方法应用的关键是要确定每个目标的权重，它反映不同目标在决策者心中的重要程度，重要程度高权重就大，反之就小。但由于权重一般由决策者给出，因而具有较大的主观性。

*注意*：
	  ①首先要将多个目标函数**统一为最大化或最小化问题**后才可以进行加权组合
	  ②如果目标函数的量纲不相同，则要将其进行**标准化**后再进行加权，标准化的方法一般是用目标函数除以某一个常量，该常量是这个目标函数的某个取值，具体取何值可根据经验确定
	  ③对对目标函数进行加权求和时，权重需要由该问题领域的专家给定，在实际建模比赛中，若无特殊说明，我们可以**令权重相同**

#### 优先级法(序贯解法)

该方法的基本思想是根据目标重要性分成不同优先级，先求优先级高的目标函数的最优值，在确保优先级高的目标获得不低于最优值的条件下，再求优先级低的目标函数，具体步骤如下：

1. 确定优先级
2. 求**第一级单目标最优值**$f_1^*=\min_{x \in \Omega}f_1(x)$
3. 以*第一级单目标等于最优值*为**约束**，求**第二级目标最优**。
$$\min f_2(x), \quad st.\begin{cases} f_1(x)=f_1^*\\ x \in \Omega \end{cases}$$
4. 以*第一、第二级单目标等于其最优值*为**约束**，求第三级目标最优。以此递推。

该方法适用于目标有明显轻重之分的问题，也就是说，各目标的重要性差距比较大，首先确保最重要的目标，然后再考虑其他目标。在同一等级的目标可能会有多个，这些目标的重要性，没有明显的差距，可以用加权方法求解。

### 典型例题
![[微信截图_20230823004103.png]]
解（线性加权法求解）：
设工厂每月生产产品A$x_1$吨，B$x_2$吨，那么产生的污染分别为$0.4x_1$吨和$0.3x_2$吨，问题的数学模型表达为**多目标规划问题**：
$$
\left\{  
             \begin{array}{**lr**}  
             \min f_1 = 2x_1 + 5 x_2, &  \\
             \min f_2 = 0.4x_1 + 0.3x_2 \\  
             \end{array}  
\right.  
$$
$$st.\begin{cases}x_1+x_2 \ge 7 \\ 0 \leq x_1 \leq 5\\ 0 \leq x_2 \leq 6\end{cases}$$
下面我们将其转换为一个*单目标规划问题*，即对上面的两个目标函数进行**加权**。由于该工厂决策认为*环境污染应优先考虑*，因此我们可以选取$f_1$和$f_2$的权重分别为 0.4 和 0.6。注意到两个目标函数的单位不同，一个为“万元”，一个为“吨”，因此我们需要首先对目标函数进行**标准化**来消除量纲的影响，然后再进行加权。由于题目中已经给了产品费用和污染量的参考值，因此我们将这两个目标函数分别除以其参考值来消除量纲。

那么加权组合后的目标函数：
$$f = 0.4 \times \frac{f_1}{30}+0.6\times \frac{f_2}{2} = \frac{0.4}{30}\times(2x_1+5x_2)+\frac{0.6}{2}\times(0.4x_1+0.3x_2)$$

那么就可以得到一个单目标规划问题，通过`python`进行求解：
```python
import cvxpy as cp  
from numpy import array  
  
c = array([11/75, 235/1500])  # 定义目标向量,这个地方需要进行化简  
a = array([[1, 1], [1, 0], [0, 1]])  # 定义约束矩阵  
b = array([100, 5, 6])  # 定义约束条件的右边向量  
d = array([7, 0, 0])  # 定义约束条件的左边向量  
  
x = cp.Variable(2, pos=True)  # 定义2个决策变量  
obj = cp.Minimize(c@x)    # 构造目标函数，注意最大化用Maximize  
cons = [d <= a@x, a@x <= b]   # 构造约束条件  
  
prob = cp.Problem(obj, cons)  # 求解问题  
prob.solve(solver='GLPK_MI')  
print("最优解为：", x.value)
```

解得$$x_1 = 5, \quad x_2 = 2, \quad f_1 = 20, \quad f_2 = 2.6$$

### 例题2(摘自教材)
![[微信图片_20230823162095.jpg]]
![[微信图片_20230823162109.jpg]]
![[微信图片编辑_20230823162129.jpg]]

**代码：**
```python
import numpy as np  
import cvxpy as cp  
  
c1 = np.array([-2, -3])  
c2 = np.array([1, 2])  
a = np.array([[0.5, 0.25], [0.2, 0.2], [1, 5], [-1, -1]])  
b = np.array([8, 4, 72, -10])  
x = cp.Variable(2, pos=True)  
obj = cp.Minimize(0.5 * (c1 + c2) @ x)  
con = [a @ x <= b]  
prob = cp.Problem(obj, con)  
prob.solve(solver='GLPK_MI')  
print('最优解为：', x.value)  
print('最优值为：', prob.value)  
  
obj1 = cp.Minimize(c1 @ x)  
prob1 = cp.Problem(obj1, con)  
prob1.solve(solver='GLPK_MI')  
v1 = prob1.value  #第一个目标函数的最优值  
obj2 = cp.Minimize(c2 @ x)  
prob2 = cp.Problem(obj2, con)  
prob2.solve(solver='GLPK_MI')  
v2 = prob2.value  #第二个目标函数的最优值  
print('两个目标函数的最优值分别为：', v1, v2)  
obj3 = cp.Minimize((c1@x-v1)**2+(c2@x-v2)**2)  
prob3 = cp.Problem(obj3, con)  
prob3.solve(solver='CVXOPT')  
print('解法二的最优解：', x.value)  
  
con.append( c1 @ x == v1)  
prob4 = cp.Problem(obj2, con)  
prob4.solve(solver='GLPK_MI')  
x3 = x.value   #提出最优解的值  
print('解法三的最优解：', x3)  
print('利润：', -c1@x3); print('排放污染物：', c2@x3)
```


### 补充：敏感性（灵敏度）分析

**敏感性分析**是指从定量分析的角度研究有关因素发生某种变化对某一个或一组关键指标影响程度的一种不确定分析技术。其实质是通过*逐一改变相关变量数值*的方法*来解释关键指标受这些因素变动影响大小的规律*

通常都是改变关键指标的系数或者权重进行分析

![[微信截图_20230823121842.png]]

## 模糊规划

### 使用背景
在一些实际问题中，约束条件可能带有弹性，目标函数可能不单一，价值系数可能带有模糊性。这些问题可以用模糊的方法来处理。

