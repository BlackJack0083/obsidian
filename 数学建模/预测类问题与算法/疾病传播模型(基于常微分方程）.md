
**基本假设**：
1. **可划分性** $\Rightarrow$  仓室模型
	1. 可以按照个体所处的发病阶段对其进行分类
	2. 个体可以在不同阶段之间转化
2. **均匀混合**假设 $\Rightarrow$ 平均场方法
	1. 每个时间步，每个个体可以从系统中随机抓取 $r$ 个（复杂网络中常用 $\left\langle k \right\rangle$，即度 )个体建立关系
	2. 每个时间步，传染病通过一条关系从感染者成功传递给健康者的概率  <br>为 $\beta$

**基本术语**：
1. **易感态**（Susceptible，S）：尚未被感染但缺乏免疫力；  
2. **感染态**(Infected，I)：染病且具有传染能力；
3. **康复态**(Removed，R)：死亡、隔离或康复的同时获得免疫。

**基本参数**：
1. $N$ ：总人数，在不考虑人口增加或减少的情况下，$N(t) \equiv N$
2. $r$：单位时间内感染者接触到的人数
3. $\beta$：传染率，表示感染者接触到易感者后，易感者得病概率
4. $\gamma （ \mu）$ ：康复率，表示感染者康复的概率
5. $s(t)$：$t$ 时刻健康人（未感染者）所占比例 $s(t) = S(t)/N$
6. $i(t)$：$t$ 时刻患者（感染者）所占比例 $i(t) = I(t)/N$
7. $\lambda$：感染率（日有效接触率），表示一个患者每天有效接触人数，接触后立刻感染。$\lambda=\beta r$(可以$\ge 1$)
8. $\sigma(R_0) = \frac{\lambda}{\mu} = \frac{r\beta}{\mu}$ ：感染数，或称基本再生数

# SI 模型

![SI模型](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信图片_20230626123101.png)
### 微分方程组
$$\left\{\begin{aligned}
	&\frac{dS}{dt} = - r\beta I \frac{S}{N} \\
	 &\frac{dI}{dt}= r\beta I\frac{S}{N}\\
	 &\ N\ =S+I
	 \end{aligned} \right.$$
$$\frac{di}{dt}=\beta r si = \beta r i (1-i)$$
发现此时方程的形式与 #logistic方程 类似，解得：$$i=\frac{i_0 e^{\beta r t}}{1-i_0+i_0 e^{\beta r t}}$$
特征时间：$$\tau = \frac{1}{\beta r}$$(传播速度的倒数)

**最终感染规模**：
	$$\left\{\begin{aligned}
	&i(t \to \infty) = 1 \\
	 &s(t \to \infty)=0\\
	 \end{aligned} \right.$$
![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信图片_20230627181351.png)

### 拓展：
1. 考虑某种使得**参数 $\lambda$ 降低**的因素`（eg. 禁止大规模集会、采取隔离措施）`
	例如，第 $60$ 天后禁止大规模集会，使得传染强度 $\lambda$ 缩小为原来的 $10$ 倍，可以看出， $60$ 天后，疾病的传染速度有了明显下降![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信截图_20230627184020.png)
2. $\lambda$ **动态变化**
	只需要在程序运行中加入 $\lambda$ 随着时间变化的函数，即可观察由于 $\lambda$ 在时间增长下减小/增大，使得 $I 、S$ 发生的变化

3. 增加人口**自然增长率和死亡率**，但不考虑疾病的死亡率
	假定初始总人口数为 $N = S+I$ ，疾病流行期间，人口出生率和自然死亡率分别为 $u、v$，不考虑因病死亡，新增人都是易感染者初始时单位时间内感染人数为 $\beta r I\frac{S}{N}$
	注意：由于总人数 $N$ 不再固定，因此我们在后期不断对总人数 $N$ 进行修正，新的总人口 $N'$ 的计算公式仍为 $S+I$ ![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信图片_20230627185514.png)
	
	对应的微分方程组为：$$\left\{\begin{aligned}
	&\frac{dS}{dt} = - r\beta I \frac{S}{N} + uN' - vS\\
	 &\frac{dI}{dt}= r\beta I\frac{S}{N}-vI\\
	 &\frac{dND}{dt}=vS +vI \\
	 &\ N'\ =S+I
	 \end{aligned} \right.$$
	取$\beta = 0.1, \ d= 0.01$，可得到
	![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信截图_20230627192145.png)

4. 不考虑人口自然出生和死亡率，只考虑**疾病的死亡率**
	假定因病的死亡率为 $d$ ，不考虑人口自然出生与死亡率
	其状态转移图形为：![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信截图_20230627192334.png)
	对应的微分方程组为：$$\left\{\begin{aligned}
	&\frac{dS}{dt} = - r\beta I \frac{S}{N} \\
	 &\frac{dI}{dt}= r\beta I\frac{S}{N}-dI\\
	 &\frac{dID}{dt}=dI \\
	 &\ N'\ =S+I
	 \end{aligned} \right.$$
	取 $\beta = 0.1, \ d=0.01$，可得到![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信图片_20230627191942.png)

5. **同时考虑**人口出生率、死亡率与疾病的死亡率
	![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信截图_20230627192943.png)
	对应得微分方程组为：$$\left\{\begin{aligned}
	&\frac{dS}{dt} = - r\beta I \frac{S}{N}+uN'-vS \\
	 &\frac{dI}{dt}= r\beta I\frac{S}{N}-dI-vI\\
	 &\frac{dID}{dt}=dI \\
	 &\frac{dND}{dt}=vS +vI \\
	 &\ N'\ =S+I
	 \end{aligned} \right.$$
	 取$\beta = 0.1,\ d= 0.01,\ u = 0.002,\ v = 0.001$，可得到![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信图片_20230627193016.png)

# SIS 模型

假设从某种疾病恢复后仍不能产生抗体，即未来仍可能患病，我们可能会经历：感染、恢复、再感染……不断循环的过程。
![SIS模型](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信截图_20230626123229.png)
### 两种微分方程刻画方法：
1. 不按比例（不进行归一化）
	$$\left\{\begin{aligned}
	&\frac{dS}{dt} = \mu I - r\beta I \frac{S}{N} \\
	 &\frac{dI}{dt}= r\beta I\frac{S}{N}-\mu I\\
	 &\ N\ =S+I
	 \end{aligned} \right.$$
	其中，$\mu I$ 为康复人数，$r\beta S \frac{I}{N}$ 为感染人数（每个感染者感染的人数($r\beta$) $\times$ 感染者总数($I$) $\times$ 接触的易感者比例($\frac{S}{N}$)）
	解得：$$I(t)=\frac{\frac{N(r\beta-\mu)}{r\beta}}{\frac{N(r\beta - \mu)}{I_0r\beta}e^{-(r\beta-\mu)t}+1}$$
	其中，$\displaystyle\lim_{t\to +\infty}I(t) = \frac{N(r\beta - \mu)}{r\beta}$，$\displaystyle\lim_{t\to +\infty}S(t) = \frac{N\mu}{r\beta}\quad(S = N-I)$

2. 归一化
	$$\left\{
	\begin{aligned}& \frac{di}{dt} = \lambda si - \mu i \\
	 &\frac{ds}{dt}= \mu i-\lambda si\\
	 &\ 1 \ = s+i 
	 \end{aligned} \right.$$
其中，$\frac{di}{dt}$也可以写成$\frac{di}{dt}=\lambda i [(1 - \frac{1}{\sigma})-i)]$， $\displaystyle\lim_{t\to +\infty}i(t) = 1 - \frac{1}{\sigma}$

**最终结果**：
![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信图片_20230626162013.png)
![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\Figure_1.png)
![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信截图_20230626162349.png)

**发现：**
	1. $r\beta$ 越大，峰值越高
	2. 若$\sigma (R_0) >1$，则必然扩散，$\leq 1$ 则不扩散
	3. 方程仍为 #logistic方程 ，$i(t)$ 图像呈S型
	4. 特征时间：$\tau = \frac{1}{\mu (R_0 -1)}$ 

### 拓展：
1.   考虑某种使得恢复率 $\mu$ 增加的因素（例如建立医院、升级医疗装备等）
	例如，第 $200$ 天引入了新的医疗装备，使得现在的恢复率 $\mu$ 增加为原来的 $10$倍
	![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信截图_20230627195524.png)

2. 在模型中增加人口出生率、自然死亡率和因病的死亡率这几个变量

3. 若一部分感染者恢复后**能产生抗体**，另一部分则**不能产生抗体**

# SIR模型

某些疾病发病迅速，但康复后会产生抗体，不会再被感染，如：天花、麻疹、腮腺炎等
![SIR模型](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信截图_20230626123323.png)
### 微分方程组：
1. 
$$\left\{\begin{aligned}&\frac{dS}{dt} = - r\beta I \frac{S}{N} \\&\frac{dI}{dt}= r\beta I\frac{S}{N}-\mu I\\&\frac{dR}{dt}= \mu I\\&\ N\ =S+I+R\end{aligned} \right.$$
	 *对这类方程无法得到解析解，需从动力系统进行分析*
	 1. 对于第一个微分方程，$\frac{dS}{dt}<0$，对$t \in (0, +\infty)$恒成立,，故$S(t)$严格递减。同时，$0 \leq S(t) \leq N$ 对所有$t \ge 0$ 均成立，故$\exists S_\infty \in (0, +\infty), \ st. \displaystyle\lim_{t \to +\infty} = S_\infty$ 趋于某个值
     2. $(1)+(2)$ 得 $\frac{d(S+I)}{dt} = -\mu I$。两边积分得$$\int_{0}^{T}\frac{d(S+I)}{dt} = -\mu \int_{0}^{T} I(t) dt$$
	 左式可得到$S(T)+I(T)-S(0)-I(0)$ ，上界为$4N$
	 令 $T \to \infty$， $\int_{0}^{\infty} I(t)dt \ge \frac{4N}{\mu}$，而 $I(t) \ge 0$ 且连续可微 $$\Rightarrow \lim_{t \to \infty}I(t) = 0 $$
	 ***故所有感染人群均将康复（不考虑死亡）***
	
   3. 达峰问题
	$\frac{dI}{dt} = 0 \quad \Rightarrow \quad r\beta I\frac{S}{N} = \mu I \quad \Rightarrow \quad S(t) = \frac{N \mu}{r\beta} = \frac{N}{\sigma}$
	发现当$S(t) = \frac{N}{\sigma}\ (s=\frac{1}{\sigma})$ 时，$I(i)$ 的导数为$0$，此时达峰

2. 归一化写法
$$\left\{\begin{aligned}&\frac{ds}{dt} = - \lambda si  \\&\frac{di}{dt}= \lambda si-\mu i\\&\frac{dr}{dt}= \mu i\\&\ 1\ =s+i+r\end{aligned} \right.$$

**最终结果：**
![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信截图_20230626162106.png)
![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信截图_20230626162115.png)
![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信图片_20230626173625.png)

**发现：**
	1. 健康人 $s(t)$ 单调递减，康复者 $r(t)$ 单调递增，均趋向稳定，而患者比例 $i(t)$ 先增后减
	2. $t \to \infty$ 时，$s(t)$ 的稳定值表示在传染病传播过程中最终没有被感染的人数比例，$i(t)$ 的最大点和最大值表示传染病高潮（患者最多）到来的时刻和人数比例，这些数值可以衡量传染病传播的强度和速度
	3. 当 $\sigma s(0)>1$ 时，$i(t)$ 先增后减，可认为传染病有一个蔓延过程；而若 $\sigma s(0) \ge 1$ 则$i(t)$ 单调减少，传染病没有蔓延开来。一般情况下 $i(0)$ 和 $r(0)$ 都很小，$s(0)$ 接近$1$，所以控制传染病蔓延需要$\sigma$ 小于$1$ ，可以通过提高卫生水平和医疗水平达到（摘自《数学建模（第五版）》)
	4. 控制传染病蔓延的另一途径时降低 $s(0)$，这可以通过提高 $r(0)$ ，即预防接种时群体免疫来实现 

***模型限制：***
	以上模型均假定参数 $\lambda$ 和 $\mu$ 为常数，而在实际传播过程中，它们会随着预防措施的加强和医疗水平的提高而发生较大变化 

### 拓展：
1. 如果在计算总人数时**剔除** $R$，即 $N = S+I$ ，结果会发生什么变化？
	$$\left\{\begin{aligned}&\frac{dS}{dt} = - r\beta I \frac{S}{N} \\&\frac{dI}{dt}= r\beta I\frac{S}{N}-\mu I\\&\frac{dR}{dt}= \mu I\\&\ N'\ =S+I\end{aligned} \right.$$
	令 $\lambda = 0.1, \ \mu = 0.02$ ，所得到的图像为： ![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信图片_20230627201413.png)
	 
2. 取 $\mu$ 为 0.01, 0.02...0.05，在一幅图中画出 $I$ 的变化趋势：
	![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信图片_20230627213501.png)
	
3. 考虑某种使得康复率 $\mu$ 增加的因素（研发疫苗、医疗设备升级等）
	eg. 第一百天后研发了疫苗，使得原来的康复率 $\mu$ 增加为原来的10倍
	设初始 $\lambda=0.1,\ \mu=0.01$ ，![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信图片_20230627215406.png)

4. 考虑疾病的死亡率（人口自然出生率和自然死亡率一般不用考虑）
	假设疾病的死亡率为 $d$，不考虑人口自然出生率和死亡率，其状态转移图形为：
	![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信截图_20230627221800.png)
	对应的微分方程为：$$\left\{\begin{aligned}&\frac{dS}{dt} = - r\beta I \frac{S}{N} \\&\frac{dI}{dt}= r\beta I\frac{S}{N}-\mu I-dI\\&\frac{dR}{dt}= \mu I\\&\frac{dID}{dt}=dI\\&\ N'\ =S+I\end{aligned} \right.$$
	取 $\lambda=0.1,\ d=0.005,\ \mu =0.02$ , ![](C:\Users\何嘉凯\Desktop\数学建模\新建文件夹\微信图片_20230627222056.png)

# SIRS

康复者 $R$ 可能会以 $\alpha$ 的转移率再次变为易感者 $S$ ，不考虑出生与死亡
![[微信截图_20230627234627.png]]
对应的微分方程为：$$\left\{\begin{aligned}&\frac{dS}{dt} = - r\beta I \frac{S}{N} + \alpha R \\&\frac{dI}{dt}= r\beta I\frac{S}{N}-\mu I \\&\frac{dR}{dt}= \mu I - \alpha R\\&\ N\ =S+I+R\end{aligned} \right.$$
取$\lambda=0.1,\  \mu=0.03,\ \alpha = 0.01$ ，得到![[50fca6c7d9cef7df1cb0381dd49c6ba.png]]

**拓展：**
1. 引入死亡率
	$$\left\{\begin{aligned}&\frac{dS}{dt} = - r\beta I \frac{S}{N} +\alpha R\\&\frac{dI}{dt}= r\beta I\frac{S}{N}-\mu I-dI\\&\frac{dR}{dt}= \mu I -\alpha R\\&\frac{dID}{dt}=dI\\&\ N'\ =S+I+R\end{aligned} \right.$$
	![[5c13af33a6a04a47b81dacff5966567.png]]
	发现所有人均因病死亡，显然不符合实际

2. 完全康复与暂时康复
	![[483e41fa9f3fcb2e89df3dba8a4d891.png]]
	$$\left\{\begin{aligned}&\frac{dS}{dt} = - r\beta I \frac{S}{N'} +\alpha R_2\\&\frac{dI}{dt}= r\beta I\frac{S}{N'}-\mu_1 I - \mu_2 I-dI\\&\frac{dR_1}{dt}= \mu_1 I \\&\frac{dR_2}{dt}=\mu_2 I-\alpha R_2\\&\frac{dID}{dt}=dI\\&\ N'\ =S+I+R\end{aligned} \right.$$
	取$\lambda=0.1,\  \mu=0.01,\ \alpha = 0.01\ d=0.005$ ，得到![[4e090ea53e9462a3c6b758e0db4edcf.png]]

# SEIR
某些疾病具有潜伏期，被感染的人群会进入潜伏期，称为潜伏者 $E$ ，潜伏者转换为感染者有一个速率 $k$， 数学意义上等价于平均潜伏期时长的倒数。在最简单的SEIR模型中，潜伏者 $E$ 不具有传染性，其状态转移图形为：![[22daf984af2afc3682b669aa3b7a0ef.png]]
对应的微分方程组为：$$\left\{\begin{aligned}&\frac{dS}{dt} = - \beta I_E \frac{S}{N} \\&\frac{dE}{dt}=\beta I_E\frac{S}{N} - \sigma E\\&\frac{dI_E}{dt}= \sigma E-zI_E\\&\frac{dI_Q}{dt}=zI_E-\gamma I_Q\\&\frac{dR}{dt}= \gamma I\end{aligned} \right.$$
令$N=1000,\ \lambda=0.1, \ k=0.2,\ \mu = 0.02$， ![[d5f1a2a362fb463c238b6f410a10361.png]]

**拓展：**
1. 潜伏者具有传染性
	假设易感者S与感染者接触且被传染的强度为$\beta_1$ ，易感者S与潜伏者E接触且被传染的强度为$\beta_2$ ，那么：
	$$\left\{\begin{aligned}&\frac{dS}{dt} = - r\beta_1 I \frac{S}{N}- r\beta_2 I \frac{S}{N} \\&\frac{dE}{dt}=r\beta_1 I\frac{S}{N}+r\beta_2 I\frac{S}{N} - kE\\&\frac{dI}{dt}= kE-\mu I\\&\frac{dR}{dt}= \mu I\\&\ N\ =S+E+I+R\end{aligned} \right.$$
	取 $\beta_1 = 0.1,\ \beta_2=0.05,\ k=0.2,\ \mu=0.02$，有：
	![[fd15110319acda94abee69ed2107936.png]]（虚线表示潜伏者E有传染性的情况）
发现传染病爆发期有所提前，且最大的患病人数也有所增加


$$\left\{\begin{aligned}&0\leq \sigma,\ z,\ \gamma \leq 1 \\&S\ge0,\ E\ge 0,\ I_E\ge0,\ I_Q\ge0,\ R\ge 0\\& N\ =S+E+I+R\end{aligned} \right.$$