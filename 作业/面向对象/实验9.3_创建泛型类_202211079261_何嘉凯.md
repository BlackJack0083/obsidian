```java
package lesson9;

import java.util.*;
public class DAO<T> {
	private Map<String, T> map = new HashMap<>();
	public void save(String key, T value) {
		map.put(key, value);
	}
	
	public T get(String s) {
		return map.get(s);
	}
	
	public void update(String key, T value) {
		map.put(key, value);
	}
	
	public List<T> list(){
		return new ArrayList<>(map.values());
	}
	
	public void remove(String key) {
		map.remove(key);
	}
	
	public static void main(String[] args) {
		// 使用DAO<Integer>
		DAO<Integer> daoInteger = new DAO<>();
		daoInteger.save("one", 1); // 保存值
		System.out.println(daoInteger.get("one"));
		
		// 使用DAO<User>
		DAO<User> daoUser = new DAO<>();
		User user1 = new User(1, 25, "John");
		daoUser.save("user1", user1);
		System.out.println("User1 name: " + daoUser.get("user1").getName());
		User user2 = new User(3, 27, "Mike");
		daoUser.update("user2", user2); // 更新值
		System.out.println("User2 id: " + daoUser.get("user2").getId());
		daoUser.remove("user1"); // 删除值
		System.out.println(daoUser.list()); // 展示列表
	}
}

class User{
	private int id, age;
	private String name;
	
	public User(int id, int age, String name) {
		this.id = id;
		this.age = age;
		this.name = name;
	}
	
	public String getName() {
		return this.name;
	}
	
	public int getId() {
		return this.id;
	}
	
	public int getAge() {
		return this.age;
	}
	
	public String toString() {
		return "User{id=" + this.id + ", name='" + this.name + "', age=" + this.age + "}";
	}
}
```

## 对应输出结果说明
![[微信截图_20231112212152.png]]
第一行为测试`Integer`类
第二至四行为测试`User`类及`save, update, remove, list`方法

# 算法原理概述
### UML图
![[微信截图_20231112213401.png]]

### 算法原理概述
这段代码主要包括两个类：`DAO<T>` 和 `User`。
#### DAO\<T> 类
这是一个**泛型类**。泛型类是一个可以处理各种数据类型的类，它使用了一个或多个类型参数（本例中是 `T`）。
##### 成员变量
* `private Map<String, T> map = new HashMap<>();`：这里定义了一个`Map`，其键为`String`类型，而值为泛型`T`类型。这意味着这个`Map`可以存储任何类型的值（由`T`决定）。
##### 方法
* `public void save(String key, T value)`：保存一个值到map中，键为`String`类型，值为泛型`T`类型。
* `public T get(String s)`：根据String类型的键从map中获取一个泛型`T`类型的值。
* `public void update(String key, T value)`：更新map中的一个值，如果键不存在则添加。
* `public List<T> list()`：返回map中所有的值，并将其转化为`List<T>`类型的列表。这里用到了**类型转换**，将map的值（集合）转化为一个`ArrayList`。
* `public void remove(String key)`：根据`String`类型的键从map中移除一个值。
#### User 类
这是一个简单的Java类，代表一个用户，包含三个属性：`id, age, name`
##### 成员变量
* `private int id, age;`：用户的ID和年龄。
* `private String name;`：用户的名字。
##### 方法
这个类有以下几个方法，分别用于获取用户的名字、ID和年龄：
* `public String getName()`
* `public int getId()`
* `public int getAge()`
还有一个重写的`toString`方法：
* `public String toString()`：这个方法重写了`Object`类的`toString`方法，用于返回一个代表`User`对象的字符串。这个字符串包含了`User`对象的所有属性。
#### main函数
主函数中创建了一个`DAO<Integer>`对象与一个`DAO<User>`对象，并对上述方法进行测试

#### 总结
1. **泛型类**：`DAO<T>`是一个泛型类，它可以处理各种数据类型。这使得代码更加灵活和可重用。
2. **List方法**：在`DAO<T>`中，`list()`方法用于获取Map中的所有值，并将其作为List返回。
3. **Map类型**：在`DAO<T>`中，使用了Map数据结构（`private Map<String, T> map`）来存储键-值对。这使得数据的存取更加高效和灵活。
4. **toString方法**：在`User`类中，`toString()`方法被重写，以返回一个包含对象所有属性的字符串。这在打印和调试时非常有用，因为它能够清晰地展示对象的内部状态。

# 实验结果与验证
## 结果验证
经检验得，结果均正确且符合实验要求，代码无误
## 讨论改进
1. **列表方法返回类型**：在 `list` 方法中，返回的是 `List<T>` 类型，但它实际上是直接从 `HashMap` 的 `values` 方法获取的。考虑明确声明返回的列表类型，例如 `ArrayList<T>`，并考虑是否需要对返回列表进行不可变处理，以防止外部修改。
2. **错误处理**：当前代码缺乏错误处理机制。例如，`get` 方法可能返回 `null`，但没有处理这种情况。可以在返回前检查值是否为 `null`，并适当地抛出异常或返回默认值。
3. **泛型限定**：在 `DAO` 类中，可以考虑对泛型 `T` 添加限定，以确保只允许特定类型的对象被保存。例如，可以定义一个接口 `DAOEntity`，然后限定 `T` 必须实现 `DAOEntity`。
