
## 身边的算法问题
### 加密与解密
在信息的传输和存储中，变换信息的表示形式来伪装需要保护的敏感信息，使非授权者不能了解被保护信息的内容。比如，在网络通讯中使用密码技术来完成敏感信息的传输，相关问题包括：
1. 机密性（confidentiality)
	仅有发送方和指定的接收方能够理解传输的报文内容。窃听者可以截取到加密了的报文，但不能还原信息
2. 鉴别（authentication)
	第三者不能冒充你的通信方，能对对方的身份进行鉴别
3. 报文完整性（message intergrity)
	能够确保通信内容在传输过程中未被篡改
4. 不可否认性（non-repudiation)
	发送方在发送报文后不能否认自己的发送行为

#### 建立模型（非对称加密）
RSA密码系统的基础是初等数论的有关理论。

> [!INFO]
>  **定义**：设 $n$ 为正整数，由模 $n$ 的所有不同剩余组成的集合称为模 $n$ 的<u>完全剩余组</u>。在模 $n$ 的完全剩余组中，删除那些与 $n$ 不互素的剩余，剩下的便组成与<u>模 $n$ 互素的剩余组</u>，与 $n$ 互素的剩余组的元素个数，称为<u>欧拉(Euler)函数</u>，记为$φ(n)$
****

**命题1**：若$(a,b)=1$，则 $\varphi(ab)=\varphi(a)\varphi(b)$
如：$a=2, b=3$ 时，$φ(2)=1, φ(3)=2, φ(6)=2$
**命题2**：若$p$为素数，则  $\varphi(p)=p-1$
如：$p=5$ 时，互素剩余组={1,2,3,4}, $φ(5)=4$
**命题3**：(欧拉定理) 若 $(a,n)=1$ ，则 $a^{\varphi(n)} ≡ 1 \pmod n$
如：$a=2, n=3$ 时，$4$ 与 $1$ 关于模 $3$ 同余
**命题4**：(费马小定理, Fermat Theory）若$p$为素数，则对所有整数 $a$ 成立

利用命题1~4可以得到RSA密码系统的建立步骤如下：
> [!TIP] 
> $Step1.$ 随机选取两个大素数，$p，q（p≠q）$，计算 $n = pq$
> $Step2.$ 计算欧拉函数 $\varphi(n)$。由命题1和命题2可知 $φ(n)=(p−1)(q−1)$
> $Step3.$ 任意选取一个正整数 $e$ 作为公开的加密密钥，要求数 $e$ 与欧拉函数$\varphi(n)$互素， 并且 $2^e > n$
>  $Step4.$ 由数 $e$ 求出解密密钥 $d$ ，它是$e$关于模 $\varphi(n)$ 的同余逆，即它是同余方程$de ≡ 1 \pmod{\varphi(n)}$ 的解。由于$e$与 $\varphi(n)$ 是互素的，因此$d$总存在。

（1）加密过程
用RSA密码系统加密明文M的过程：先将明文$M$数值化，如果$M$太长，可以将$M$分成若干块，通常要求 $M<n$ 。然后将编码后的数字作以下运算$$E(M)=M^e≡C\pmod n$$即得密文C。

（2）解密过程
解密时，只要利用解密密钥$d$，对密文做相同的运算$$D(C)=C^d≡M \pmod n$$即可还原出明文M。

> [!example]
> 取$p=11, q=19$，计算可得$n=pq=209$，$φ(n)=(p−1)(q−1)=180$。取与$φ(n)$互素的正整数  $e=97$ 作为公开密钥，求解同余方程$97 d≡1\pmod{180}$，得到解  $d=13$  作为解密密钥。
> **对明文“CODE”的加密过程：**
>首先将明文数值化为$M=02140304$，这里的$M$太大，我们将之分成几组，使得每一组都小于$n$。如下分组：$M_1=02， M_2=14， M_3=03， M_4=04$，用(1)式对每组$M_i$分别进行加密可得
>$$\begin{equation}
>	\begin{aligned}
>		C_1&=M_1^e=02^{97}≡128(mod 209)，\\
>		C_2&=M_2^e=14^{97}≡174(mod 209)，\\
>		C_3&=M_3^e=03^{97}≡097(mod 209)，\\
>		C_4&=M_4^e=04^{97}≡082(mod 209)
>	\end{aligned}
>\end{equation}$$
>于是加密后的密文为$C=128174097082$
>**对密文128174097082的解密过程：**
>若我们要将密文C=128174097082解密，则要利用解密密钥$d=13$计算(2)式即可得到原文
> $$\begin{equation}
>	\begin{aligned}
>		M_1&=C_1^d=128^{13}≡02(mod209)，\\
>		M_2&=C_2^d=174^{13}≡14(mod209)，\\
>		M_3&=C_3^d=097^{13}≡03(mod209)，\\
>		M_4&=C_4^d=082^{13}≡04(mod209)
>	\end{aligned}
>\end{equation}$$

> [!summary]
> RSA基于一个十分简单的数论事实：将两个大素数相乘十分容易，但是想要对其乘积进行因式分解却极其困难，因此可以将乘积公开，进行加解密运算
> RSA算法非常可靠，密钥越长，越难破解。根据已经披露的文献，目前已知被破解的最长RSA密钥是768个二进制位
